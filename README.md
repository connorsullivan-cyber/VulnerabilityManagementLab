<h1>Vulnerability Management Lab</h1>

 

<h2>Description</h2>
In this project I will explore vulnerability scanning and vulnerability remediation. 


1. I will be using Nessus Essentials to scan a local virtual machine on VMWare Workstaion that will run credentialed scans to discover vulnerabilities. 
2. After discovering the vulnerabilities, I will then remediate them.
3. Once the vulnerabilities are remediated, I will rescan to verify the remediations.
<br />


<h2>Languages and Utilities Used</h2>

- <b>Nessus Essentials</b> 
- <b>VMWare Workstation</b>

<h2>Environments Used </h2>

- <b>Windows 10</b> 

<h2>Program walk-through:</h2>

<p align="center">
<b>Launch the virtual machine:</b> <br/>

<img src="https://i.imgur.com/cle6Rwl.jpg" height="80%" width="80%" alt="Launch virtual machine"/>
<br />
<br />
<b>Disable default firewall:</b>  <br/>
In order for Nessus to be able to scan the virtual machine, we will need to disable the default firewall of the Windows virtual machine. We will do so by opening up the Windows Defender Firewall properties and setting the firewall state to off for each tab (Domain, Private, Public). <br/>
We can ensure that the machine is able to be scanned by opening up the command line on our own computer and pinging to the virtual machine's ip. <br/>
<br />
<img src="https://i.imgur.com/UfEZR2a.jpg" height="80%" width="80%" alt="Disable default firewall"/> <br/>
<br />
<img src="https://i.imgur.com/R4WrtNh.jpeg" height="80%" width="80%" alt="Ping"/>
<br />
<br />
<b>Setup first scan</b> <br/>
Now that our virtual machine is able to be accessed, we will launch Nessus and create our first scan! We can do this by going to New Scan > Basic Network Scan and then typing the ip address of our virtual machine in the target box. <br/>
<br />
<img src="https://i.imgur.com/YQlX8jP.jpg" height="80%" width="80%" alt="scan setup"/> <br/>
<br />
After running the scan, we can go to the vulnerabilities section to see the results. <br/>
<br />
<img src="https://i.imgur.com/lWwMHZs.jpg" height="80%" width="80%" alt="vulnerabilities"/>
<br />
<br />
<b>Prepare virtual machine for credentialed scans</b>  <br/>

Now that we have run our first scan and gotten a view of the vulnerabilities, we will now set up the machine to be able to run a credentialed scan. A credentialed scan is a more thorough scan of the system that uses admin privileges.
The first thing we will need to do is open up services (type services.msc into the search bar) and enable the Remote Registry. This will allow Nessus to go through the system and look for vulnerabilities. <br/>

<img src="https://i.imgur.com/vdwTqJ7.jpeg" height="80%" width="80%" alt="services"/>
<br />
Next we will disable the User Account Control settings.
<br />  <br/>
<img src="https://i.imgur.com/trtz1nE.jpeg" height="80%" width="80%" alt="useraccounts"/>
<br />
Then we will go to the Registry Editor to add a D-word that will further disable the User Account. To do this we will type "regedit" into the search bar and then navigate to:</br>
Computer/HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System </br></br>
<img src="https://i.imgur.com/Ve3PUG6.jpg" height="80%" width="80%" alt="services"/>
From here we will right click and add new D-Word called "LocalAccountTokenFilterPolicy" and set the value to 1.</br>
Now we can reboot the virtual machine so the changes can update. </br>
Time to add credentials! To do so, we will go back to our scan in Nessus > click the check to highlight > click "Configure" >  click the "Credentials" tab > then add in the login information for our virtual machine and hit "save". </br> </br>
Now we can run our scan one more time.
<br />
<img src="https://i.imgur.com/5IgoITW.jpeg" height="80%" width="80%" alt="credential scan"/>
<br />
Now we can run our scan one more time.
<br />
<img src="https://i.imgur.com/meLCqMS.jpeg" height="80%" width="80%" alt="second scan"/> </br></br>
Wow! That's quite the difference in vulnerabilities. Adding in the credentials allowed the machine to be scanned much more thoroughly, resulting in more "critical" and "high" alerts. Upon further inspection, it appears that most of the high alerts are due to Windows updates being needed. </br>

Now that we have observed our machines vulnerabilities, we are going to download an old version of Firefox that should have a lot of vulnerabilities. I downloaded an old version from the Firefox archives and ran the scanner one more time. </br>
<img src="https://i.imgur.com/oLlnHCX.jpeg" height="80%" width="80%" alt="third scan"/> </br>
<img src="https://i.imgur.com/OXprzFx.jpeg" height="80%" width="80%" alt="remediations"/> </br>
These results show a large amount of critical vulnerabilities. Upon further inspection, we see that they are related to Firefox. Under "Remediations" we can see recommendations to update to a newer version, but we are just going to go ahead and delete the app altogether.</br></br>
Our first step in remediating is going to be deleting Firefox. This should get rid of a large amount of the critical alerts.</br>
Second, we are going to run Windows updates. This will likely take several tries as there appeared to be a decent amount of vulnerabilities on the system from the start.</br></br>
After we have no more updates available, we will reboot the virtual machine one last time. Now that the updates are done, we should be able to run the scanner again. This should reveal far fewer critical alerts.

<img src="https://i.imgur.com/qWlr1mH.jpeg" height="80%" width="80%" alt="Disk Sanitization Steps"/></br>

Voila! There are still some high alerts, some related to Internet Explorer and Microsoft Office, but the large amount of critical and high alerts have been removed from the system. We can continue remediating by going through the recommendations until there are not more vulnerabilities left.</br>
</br>
Thank you for joining me!
